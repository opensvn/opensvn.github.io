
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  
    <title>PyQt编程第七章 使用Qt Designer | opensvn</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="opensvn">
    

    
    <meta name="description" content="用户界面保存在.ui文件中，包含一个窗口部件和布局的详细情况。Qt Designer能够关联标签和它的伙伴，设置tab顺序(这个也可以用QWidget.setTabOrder()完成)。Qt Designer也能够关联信号和槽，但是只能是内置的信号和槽。
一旦用户界面设计完成并保存在.ui文件，必须转化为代码才能使用。这个可以用pyuic4完成，比如：
$ pyuic4 -o ui_findand">
<meta property="og:type" content="article">
<meta property="og:title" content="PyQt编程第七章 使用Qt Designer">
<meta property="og:url" content="https://opensvn.github.io/2015/10/28/pyqt-7/index.html">
<meta property="og:site_name" content="opensvn">
<meta property="og:description" content="用户界面保存在.ui文件中，包含一个窗口部件和布局的详细情况。Qt Designer能够关联标签和它的伙伴，设置tab顺序(这个也可以用QWidget.setTabOrder()完成)。Qt Designer也能够关联信号和槽，但是只能是内置的信号和槽。
一旦用户界面设计完成并保存在.ui文件，必须转化为代码才能使用。这个可以用pyuic4完成，比如：
$ pyuic4 -o ui_findand">
<meta property="og:updated_time" content="2015-10-30T00:20:27.590Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PyQt编程第七章 使用Qt Designer">
<meta name="twitter:description" content="用户界面保存在.ui文件中，包含一个窗口部件和布局的详细情况。Qt Designer能够关联标签和它的伙伴，设置tab顺序(这个也可以用QWidget.setTabOrder()完成)。Qt Designer也能够关联信号和槽，但是只能是内置的信号和槽。
一旦用户界面设计完成并保存在.ui文件，必须转化为代码才能使用。这个可以用pyuic4完成，比如：
$ pyuic4 -o ui_findand">

    
    <link rel="alternative" href="/atom.xml" title="opensvn" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/author.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/author.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/author.jpg" alt="opensvn" title="opensvn"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="opensvn">opensvn</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页 | Home</a></li>
					
						<li><a href="/archives">归档 | Archives</a></li>
					
						<li><a href="/about">关于 | About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:opensvn.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/10/28/pyqt-7/" title="PyQt编程第七章 使用Qt Designer" itemprop="url">PyQt编程第七章 使用Qt Designer</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="opensvn" target="_blank" itemprop="author">opensvn</a>
		
  <p class="article-time">
    <time datetime="2015-10-28T00:50:57.000Z" itemprop="datePublished"> 发表于 2015-10-28</time>
    
  </p>
</header>
	<div class="article-content">
		
		<p>用户界面保存在.ui文件中，包含一个窗口部件和布局的详细情况。<strong>Qt Designer</strong>能够关联标签和它的伙伴，<br>设置tab顺序(这个也可以用<code>QWidget.setTabOrder()</code>完成)。<strong>Qt Designer</strong>也能够关联信号和槽，<br>但是只能是内置的信号和槽。</p>
<p>一旦用户界面设计完成并保存在.ui文件，必须转化为代码才能使用。这个可以用<code>pyuic4</code>完成，比如：</p>
<pre><code>$ pyuic4 -o ui_findandreplacedlg<span class="class">.py</span> findandreplacedlg.ui
</code></pre><h1 id="设计用户界面">设计用户界面</h1><p>使用<strong>Qt Designer</strong>通用步骤：</p>
<ol>
<li>拖动一个部件到窗体合适的位置，通常只有容器部件需要改变大小。</li>
<li>设置部件的属性。如果部件会在代码里面用到，设置一个有意义的名字。</li>
<li>重复1和2直到所有部件都在窗体上。</li>
<li>如果存在大的间隙，添加间隔器。</li>
<li>选择2个或多个部件进行布局(Shift+Click)，使用一个布局管理器布局。</li>
<li>重复5直到所有部件已经布局完毕。</li>
<li>点击窗体(不选择任何部件)，使用一个布局管理器布局窗体。</li>
<li>创建标签的伙伴。</li>
<li>设置窗体的tab顺序，如果顺序错误。</li>
<li>创建合适的内置信号和槽的关联。</li>
<li>预览窗体，检查所有东西都按照自己的意图工作。</li>
<li>设置窗体的对象名字和标题并保存。</li>
</ol>
<p>尽管可以先将布局拖进窗体，然后再添加部件到布局，但是最好是先将部件添加到窗体，然后再进行布局。</p>
<p><code>addStretch()</code>和插入<code>QSpacerItem</code>一样。</p>
<p>预览窗口点击Form-&gt;Preview或者Ctrl+R。如果想预览不同风格，点击Form-&gt;Preview in</p>
<h1 id="实现对话框">实现对话框</h1><p>当使用<strong>Qt Designer</strong>创建一个用户界面时，我们使用多继承创建一个子类。第一个父类是<code>QDialog</code>，<br>第二个父类是用<strong>Qt Designer</strong>设计的界面。</p>
<pre><code><span class="import"><span class="keyword">import</span> re</span>
<span class="title">from</span> <span class="type">PyQt4</span>.<span class="type">QtCore</span> <span class="import"><span class="keyword">import</span> *</span>
<span class="title">from</span> <span class="type">PyQt4</span>.<span class="type">QtGui</span> <span class="import"><span class="keyword">import</span> *</span>
<span class="import"><span class="keyword">import</span> ui_findandreplacedlg</span>
<span class="class">
<span class="keyword">class</span> <span class="type">FindAndReplaceDlg</span><span class="container">(<span class="type">QDialog</span>,
    <span class="title">ui_findandreplacedlg</span>.<span class="type">Ui_FindAndReplaceDlg</span>)</span>:
    def __init__<span class="container">(<span class="title">self</span>, <span class="title">text</span>, <span class="title">parent</span>=<span class="type">None</span>)</span>:
        super<span class="container">(<span class="type">FindAndReplaceDlg</span>, <span class="title">self</span>)</span>.__init__<span class="container">(<span class="title">parent</span>)</span>
        self.__text = unicode<span class="container">(<span class="title">text</span>)</span>
        self.__index = 0
        self.setupUi<span class="container">(<span class="title">self</span>)</span>
        if not <span class="type">MAC</span>:
            self.findButton.setFocusPolicy<span class="container">(<span class="type">Qt</span>.<span class="type">NoFocus</span>)</span>
            self.replaceButton.setFocusPolicy<span class="container">(<span class="type">Qt</span>.<span class="type">NoFocus</span>)</span>
            self.replaceAllButton.setFocusPolicy<span class="container">(<span class="type">Qt</span>.<span class="type">NoFocus</span>)</span>
            self.closeButton.setFocusPolicy<span class="container">(<span class="type">Qt</span>.<span class="type">NoFocus</span>)</span>
        self.updateUi<span class="container">()</span></span>
</code></pre><p><code>setupUi()</code>方法由生成的ui模块提供，调用这个方法创建用户界面。<br><code>setupUi()</code>方法调用<code>QtCore.QMetaObject.connectSlotsByName()</code>创建信号和槽之间的联系。<br>任何具有形式<code>on_widgetName_signalName</code>的槽都有一个信号连接到它。</p>
<pre><code><span class="decorator">@pyqtSignature('QString')</span>
<span class="function"><span class="keyword">def</span> <span class="title">on_findLineText_textEdited</span><span class="params">(self, text)</span>:</span>
    self.__index = <span class="number">0</span>
    self.updateUi()
</code></pre><p>多亏<code>setupUi()</code>，这个方法自动连接到findLineEdit的<code>textEdited()</code>信号。当需要自动连接到指定<br>信号，使用<code>@pyqtSignature</code>装饰指定信号参数。装饰的作用是区分同名但参数不同的信号。</p>
<pre><code><span class="function"><span class="keyword">def</span> <span class="title">updateUi</span><span class="params">(self)</span>:</span>
    enable = <span class="keyword">not</span> self.findLineEdit.text().isEmpty()
    self.findButton.setEnabled(enable)
    self.replaceButton.setEnabled(enable)
    self.replaceAllButton.setEnabled(enable)

<span class="function"><span class="keyword">def</span> <span class="title">text</span><span class="params">(self)</span>:</span>
    <span class="keyword">return</span> self.__text

<span class="decorator">@pyqtSignature('')</span>
<span class="function"><span class="keyword">def</span> <span class="title">on_findButton_clicked</span><span class="params">(self)</span>:</span>
    regex = self.makeRegex()
    match = regex.search(self.__text, self.__index)
    <span class="keyword">if</span> match <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:
        self.__index = match.end()
        self.emit(SIGNAL(<span class="string">'found'</span>), match.start())
    <span class="keyword">else</span>:
        self.emit(SIGNAL(<span class="string">'notfound'</span>))

<span class="function"><span class="keyword">def</span> <span class="title">makeRegex</span><span class="params">(self)</span>:</span>
    findText = unicode(self.findLineEdit.text())
    <span class="keyword">if</span> unicode(self.syntaxComboBox.currentText()) == <span class="string">'Literal'</span>:
        findText = re.escape(findText)
    flags = re.MULTILINE|re.DOTALL|re.UNICODE
    <span class="keyword">if</span> <span class="keyword">not</span> self.caseCheckBox.isChecked():
        flags |= re.IGNORECASE
    <span class="keyword">if</span> self.wholeCheckBox.isChecked():
        findText = <span class="string">r'\b%s\b'</span> % findText
    <span class="keyword">return</span> re.compile(findText, flags)
</code></pre><p>如果被搜索的文本是<code>QString</code>而不是<code>unicode</code>，则选择<code>QRegExp</code>更好。</p>
<pre><code><span class="decorator">@pyqtSignature('')</span>
<span class="function"><span class="keyword">def</span> <span class="title">on_replaceButton_clicked</span><span class="params">(self)</span>:</span>
    regex = self.makeRegex()
    self.__text = regex.sub(unicode(self.replaceLineEdit.text()),
        self.__text, <span class="number">1</span>)

<span class="decorator">@pyqtSignature('')</span>
<span class="function"><span class="keyword">def</span> <span class="title">on_replaceAllButton_clicked</span><span class="params">(self)</span>:</span>
    regex = self.makeRegex()
    self.__text = regex.sub(unicode(self.replaceLineEdit.text()),
        self.__text)
</code></pre><h1 id="测试对话框">测试对话框</h1><pre><code><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span>
    <span class="keyword">import</span> sys

    text = <span class="string">"""US experience shows that, unlike traditional patents,
software patents do not encourage innovation and R&amp;D, quite the
contrary. In particular they hurt small and medium-sized enterprises
and generally newcomers in the market. They will just weaken the market
and increase spending on patents and litigation, at the expense of
technological innovation and research. Especially dangerous are
attempts to abuse the patent system by preventing interoperability as a
means of avoiding competition with technological ability.
--- Extract quoted from Linus Torvalds and Alan Cox's letter
to the President of the European Parliament
http://www.effi.org/patentit/patents_torvalds_cox.html"""</span>

    <span class="function"><span class="keyword">def</span> <span class="title">found</span><span class="params">(where)</span>:</span>
        <span class="keyword">print</span> <span class="string">'Found at %d'</span> % where

    <span class="function"><span class="keyword">def</span> <span class="title">nomore</span><span class="params">()</span>:</span>
        <span class="keyword">print</span> <span class="string">'No more found'</span>

    app = QApplication(sys.argv)
    form = FindAndReplaceDlg(text)
    form.connect(form, SIGNAL(<span class="string">'found'</span>), found)
    form.connect(form, SIGNAL(<span class="string">'notfound'</span>), nomore)
    form.show()
    app.exec_()
    <span class="keyword">print</span> form.text()
</code></pre><h1 id="总结">总结</h1><p>使用<strong>Qt Designer</strong>和手工创建界面最大的不同是在初始化的时候，我们简单地调用<code>setupUi()</code>创建界面，<br>布局，信号和槽的关联。槽的命名惯例是<code>on_widgetName_signalName</code>，连同<code>@pyqtSignature</code>装饰<br>就可以利用<code>setupUi()</code>自动关联信号和槽。</p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/PyQt/">PyQt</a><a href="/tags/Python/">Python</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="https://opensvn.github.io/2015/10/28/pyqt-7/" data-title="PyQt编程第七章 使用Qt Designer | opensvn" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/10/30/pyqt-8/" title="PyQt编程第八章 数据处理和自定义文件类型">
  <strong>上一篇：</strong><br/>
  <span>
  PyQt编程第八章 数据处理和自定义文件类型</span>
</a>
</div>


<div class="next">
<a href="/2015/10/23/project-euler-1/"  title="Project Euler Problem 1">
 <strong>下一篇：</strong><br/> 
 <span>Project Euler Problem 1
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2015/10/28/pyqt-7/" data-title="PyQt编程第七章 使用Qt Designer" data-url="https://opensvn.github.io/2015/10/28/pyqt-7/"></div>
</section>


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  

  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Python/" title="Python">Python<sup>12</sup></a></li>
			
		
			
				<li><a href="/tags/PyQt/" title="PyQt">PyQt<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Pygame/" title="Pygame">Pygame<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/C/" title="C++">C++<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Markdown/" title="Markdown">Markdown<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Project-Euler/" title="Project Euler">Project Euler<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Hexo/" title="Hexo">Hexo<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Linux/" title="Linux">Linux<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/C/" title="C">C<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello, I&#39;m opensvn. <br/>
			Try to do better.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		<a href="https://github.com/opensvn" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2015 
		
		<a href="/about" target="_blank" title="opensvn">opensvn</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
        getSize();
        if (myWidth >= 1024) {
          c.click();
        }
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"opensvn"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F86bb0f34aeafce8b9262f5000b269d72' type='text/javascript'%3E%3C/script%3E"));
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
